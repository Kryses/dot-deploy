# nnn-install.yml
---
- name: Check NeoVim installed
  become: false
  command: which nnn
  register: nnn_check
  ignore_errors: yes

- name: Check NNN Cloned
  stat:
    path: "{{ user_build_folder.path }}/nnn"
  register: nnn_cloned_folder

- name: Clone NNN to {{ user_build_folder.path }}/nnn
  git:
    repo: "https://github.com/jarun/nnn.git"
    dest: "{{ user_build_folder.path }}/nnn"
  when: nnn_cloned_folder.stat.exists == false

- name: Build NNN
  shell: "make O_NERD=1 PREFIX={{ user_local_folder.path }}"
  args:
    chdir: "{{ user_build_folder.path }}/nnn"
  when: nnn_check.rc != 0

- name: Install NNN
  become: true
  shell: "make install"
  args:
    chdir: "{{ user_build_folder.path }}/nnn"
    creates: "{{ user_local_folder.path }}/bin/nnn"
    
